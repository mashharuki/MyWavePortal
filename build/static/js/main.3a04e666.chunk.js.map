{"version":3,"sources":["App.js","index.js"],"names":["contractABI","abi","contractAddress","App","useState","currentAccount","setCurrentAccount","messageValue","setMessageValue","allWaves","setAllWaves","waveBalance","setWaveBalance","console","log","checkIfWalletIsConnected","window","ethereum","request","method","accounts","length","account","getAllWaves","useEffect","provider","ethers","providers","Web3Provider","signer","getSigner","wavePortalContract","Contract","waves","wavesCleaned","map","wave","address","waver","timestamp","Date","message","getBalance","contractBalance","utils","formatEther","onNewWave","from","prevState","on","off","connectWallet","alert","getTotalWaves","count","toNumber","gasLimit","waveTxn","hash","wait","contractBalance_post","className","role","aria-label","onClick","name","placeholder","type","id","value","onChange","e","target","slice","reverse","index","key","style","backgroundColor","marginTop","padding","toString","ReactDOM","render","document","getElementById"],"mappings":"6w3BAKA,IAAMA,EAAcC,EAAIA,IAClBC,EAAkB,6CAyPTC,MAvPf,WAEE,MAA4CC,mBAAS,IAArD,mBAAOC,EAAP,KAAuBC,EAAvB,KACA,EAAwCF,mBAAS,IAAjD,mBAAOG,EAAP,KAAqBC,EAArB,KACA,EAAgCJ,mBAAS,IAAzC,mBAAOK,EAAP,KAAiBC,EAAjB,KACA,EAAsCN,mBAAS,GAA/C,mBAAOO,EAAP,KAAoBC,EAApB,KACAC,QAAQC,IAAI,mBAAoBT,GAGhC,IAAMU,EAAwB,uCAAG,4GAERC,QAAbC,EAFqB,EAErBA,UAINJ,QAAQC,IAAI,8BAA+BG,GAF3CJ,QAAQC,IAAI,gCAJe,SASNG,EAASC,QAAQ,CAAEC,OAAQ,iBATrB,OAWL,KAFlBC,EATuB,QAWhBC,QACLC,EAAUF,EAAS,GACzBP,QAAQC,IAAI,+BAAgCQ,GAE5ChB,EAAkBgB,GAClBC,KAEAV,QAAQC,IAAI,+BAlBe,gDAqB7BD,QAAQC,IAAR,MArB6B,yDAAH,qDAyB9BU,qBAAU,WACRT,MACC,IAGH,IAAMQ,EAAW,uCAAG,uGACGP,OAAbC,EADU,EACVA,SADU,UAIVA,EAJU,wBAKNQ,EAAW,IAAIC,IAAOC,UAAUC,aAAaX,GAC7CY,EAASJ,EAASK,YAClBC,EAAqB,IAAIL,IAAOM,SACpC9B,EACAF,EACA6B,GAVU,SAaQE,EAAmBR,cAb3B,cAaNU,EAbM,OAeNC,EAAeD,EAAME,KAAI,SAACC,GAC9B,MAAO,CACLC,QAASD,EAAKE,MACdC,UAAW,IAAIC,KAAsB,IAAjBJ,EAAKG,WACzBE,QAASL,EAAKK,YAGlB/B,EAAYwB,GAtBA,UAwBgBT,EAASiB,WAAWX,EAAmBM,SAxBvD,QAwBRM,EAxBQ,OAyBZ/B,EAAec,IAAOkB,MAAMC,YAAYF,IAzB5B,wBA2Bd9B,QAAQC,IAAI,kCA3BE,0DA8BhBD,QAAQC,IAAR,MA9BgB,0DAAH,qDAmCjBU,qBAAU,WACR,IAAIO,EAEEe,EAAY,SAACC,EAAMR,EAAWE,GAClC5B,QAAQC,IAAI,UAAWiC,EAAMR,EAAWE,GACxC/B,GAAY,SAACsC,GAAD,4BACPA,GADO,CAEV,CACEX,QAASU,EACTR,UAAW,IAAIC,KAAiB,IAAZD,GACpBE,QAASA,SAKf,GAAIzB,OAAOC,SAAU,CACnB,IACMY,EADW,IAAIH,IAAOC,UAAUC,aAAaZ,OAAOC,UAClCa,aAExBC,EAAqB,IAAIL,IAAOM,SAC9B9B,EACAF,EACA6B,IAGiBoB,GAAG,UAAWH,GAInC,OAAM,WACAf,GAEFA,EAAmBmB,IAAI,UAAWJ,MAGrC,IAGH,IAAMK,EAAa,uCAAG,sGAEGnC,OAAbC,EAFU,EAEVA,SAFU,uBAIhBmC,MAAM,iBAJU,0CAQKnC,EAASC,QAAQ,CACtCC,OAAQ,wBATQ,OAQZC,EARY,OAWlBP,QAAQC,IAAI,cAAeM,EAAS,IACpCd,EAAkBc,EAAS,IAZT,kDAclBP,QAAQC,IAAR,MAdkB,0DAAH,qDAkBbsB,EAAI,uCAAG,kHAEYpB,SAAbC,EAFC,EAEDA,UAFC,wBAIDQ,EAAW,IAAIC,IAAOC,UAAUC,aAAaX,GAC7CY,EAASJ,EAASK,YAElBC,EAAqB,IAAIL,IAAOM,SACpC9B,EACAF,EACA6B,GAVK,SAaWE,EAAmBsB,gBAb9B,cAaHC,EAbG,OAcPzC,QAAQC,IAAI,gCAAiCwC,EAAMC,YAd5C,UAgBqB9B,EAASiB,WAAWX,EAAmBM,SAhB5D,eAgBHM,EAhBG,OAiBP9B,QAAQC,IAAI,oBAAqBY,IAAOkB,MAAMC,YAAYF,IAjBnD,UAmBeZ,EAAmBK,KAAK7B,EAAc,CAC1DiD,SAAU,MApBL,eAmBDC,EAnBC,OAsBP5C,QAAQC,IAAI,YAAa2C,EAAQC,MAtB1B,UAuBDD,EAAQE,OAvBP,eAwBP9C,QAAQC,IAAI,YAAa2C,EAAQC,MAxB1B,UAyBO3B,EAAmBsB,gBAzB1B,eAyBPC,EAzBO,OA0BPzC,QAAQC,IAAI,gCAAiCwC,EAAMC,YA1B5C,UA4B0B9B,EAASiB,WAAWX,EAAmBM,SA5BjE,SA4BHuB,EA5BG,QA8BoBjB,EAEzB9B,QAAQC,IAAI,iBAEZD,QAAQC,IAAI,wBAEdD,QAAQC,IAAI,+BAAgCY,IAAOkB,MAAMC,YAAYe,IACrEhD,EAAec,IAAOkB,MAAMC,YAAYe,IArCjC,wBAuCP/C,QAAQC,IAAI,kCAvCL,0DA0CTD,QAAQC,IAAR,MA1CS,0DAAH,qDA8CV,OACE,yBAAK+C,UAAU,iBACb,yBAAKA,UAAU,iBACb,yBAAKA,UAAU,UACb,0BAAMC,KAAK,MAAMC,aAAW,aAA5B,gBADF,IAGY,IAHZ,YAMA,8MAEE,0BAAMD,KAAK,MAAMC,aAAW,aAA5B,gBAFF,mDAME,0BAAMD,KAAK,MAAMC,aAAW,SAA5B,WAIF,yBAAKF,UAAU,WAAf,kFACgB,2BAAIlD,EAAJ,SAEhB,4BAAQkD,UAAU,aAAaG,QAAS5B,GAAxC,eAIE/B,GACA,4BAAQwD,UAAU,aAAaG,QAASb,GAAxC,kBAID9C,GACC,4BAAQwD,UAAU,aAAaG,QAASb,GAAxC,oBAID9C,GACC,8BACE4D,KAAK,cACLC,YAAY,yDACZC,KAAK,OACLC,GAAG,UACHC,MAAO9D,EACP+D,SAAU,SAACC,GAAD,OAAO/D,EAAgB+D,EAAEC,OAAOH,UAG7ChE,GACCI,EACGgE,MAAM,GACNC,UACAvC,KAAI,SAACC,EAAMuC,GACV,OACE,yBACEC,IAAKD,EACLE,MAAO,CACLC,gBAAiB,UACjBC,UAAW,OACXC,QAAS,QAGX,yCAAe5C,EAAKC,SACpB,sCAAYD,EAAKG,UAAU0C,YAC3B,yCAAe7C,EAAKK,gBCjPtCyC,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,W","file":"static/js/main.3a04e666.chunk.js","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { ethers } from \"ethers\";\nimport abi from \"./uitls/WavePortal.json\";\nimport './App.css';\n\nconst contractABI = abi.abi;\nconst contractAddress = \"0x7C7Bd8BC7cEBeb774FC2E94CA8e7f9c0a752e682\";\n\nfunction App() {\n  // ã‚¹ãƒ†ãƒ¼ãƒˆå¤‰æ•°\n  const [currentAccount, setCurrentAccount] = useState(\"\");\n  const [messageValue, setMessageValue] = useState(\"\");\n  const [allWaves, setAllWaves] = useState([]);\n  const [waveBalance, setWaveBalance] = useState(0);\n  console.log(\"currentAccount: \", currentAccount);\n\n  // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šãƒã‚§ãƒƒã‚¯\n  const checkIfWalletIsConnected = async () => {\n    try {\n      const { ethereum } = window;\n      if (!ethereum) {\n        console.log(\"Make sure you have MetaMask!\");\n      } else {\n        console.log(\"We have the ethereum object\", ethereum);\n      }\n      /* ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒè¨±å¯ã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ */\n      const accounts = await ethereum.request({ method: \"eth_accounts\" });\n      // ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ãŒè¦‹ã¤ã‹ã£ãŸã‹ã©ã†ã‹ãƒã‚§ãƒƒã‚¯\n      if (accounts.length !== 0) {\n        const account = accounts[0];\n        console.log(\"Found an authorized account:\", account);\n        // ã‚¹ãƒ†ãƒ¼ãƒˆå¤‰æ•°ã«è©°ã‚ã‚‹ã€‚\n        setCurrentAccount(account);\n        getAllWaves();\n      } else {\n        console.log(\"No authorized account found\");\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  \n  useEffect(() => {\n    checkIfWalletIsConnected();\n  }, []);\n\n  // å…¨ã¦ã®Wavesã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰\n  const getAllWaves = async () => {\n    const { ethereum } = window;\n\n    try {\n        if (ethereum) {\n          const provider = new ethers.providers.Web3Provider(ethereum);\n          const signer = provider.getSigner();\n          const wavePortalContract = new ethers.Contract(\n            contractAddress,\n            contractABI,\n            signer\n          );\n          // getAllWaves()ã‚’å‘¼ã³å‡ºã™ã€‚\n          const waves = await wavePortalContract.getAllWaves();\n          // å–å¾—ã—ãŸçµæœã‚’å¤‰æ›ã—è©°ã‚ã‚‹ã€‚  \n          const wavesCleaned = waves.map((wave) => {\n            return {\n              address: wave.waver,\n              timestamp: new Date(wave.timestamp * 1000),\n              message: wave.message,\n            };\n          });\n          setAllWaves(wavesCleaned);\n          // ç¾åœ¨ã®è³‡ç”£é¡ã‚’å–å¾—ã—ã¦ã‚»ãƒƒãƒˆã™ã‚‹ã€‚\n          let contractBalance = await provider.getBalance(wavePortalContract.address);\n          setWaveBalance(ethers.utils.formatEther(contractBalance));\n      } else {\n        console.log(\"Ethereum object doesn't exist!\");\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  // ã‚¤ãƒ™ãƒ³ãƒˆãŒemitã•ã‚ŒãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ç”»é¢ã‚’å†æç”»ã™ã‚‹ã€‚\n  useEffect(() => {\n    let wavePortalContract;\n\n    const onNewWave = (from, timestamp, message) => {\n      console.log(\"NewWave\", from, timestamp, message);\n      setAllWaves((prevState) => [\n        ...prevState,\n        {\n          address: from,\n          timestamp: new Date(timestamp * 1000),\n          message: message,\n        },\n      ]);\n    };\n    /* NewWaveã‚¤ãƒ™ãƒ³ãƒˆãŒã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‹ã‚‰ç™ºä¿¡ã•ã‚ŒãŸã¨ãã«ã€æƒ…å ±ã‚’å—ã‘å–ã‚Šã¾ã™ */\n    if (window.ethereum) {\n      const provider = new ethers.providers.Web3Provider(window.ethereum);\n      const signer = provider.getSigner();\n\n      wavePortalContract = new ethers.Contract(\n        contractAddress,\n        contractABI,\n        signer\n      );\n      // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠé–‹å§‹\n      wavePortalContract.on(\"NewWave\", onNewWave);\n    }\n\n    /*ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ã‚’é˜²ããŸã‚ã«ã€NewWaveã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è§£é™¤ã—ã¾ã™*/\n    return() => {\n      if (wavePortalContract) {\n        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠçµ‚äº†\n        wavePortalContract.off(\"NewWave\", onNewWave);\n      }\n    };\n  }, []);\n\n  // connectWalletãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…\n  const connectWallet = async () => {\n    try {\n      const { ethereum } = window;\n      if (!ethereum) {\n        alert(\"Get MetaMask!\");\n        return;\n      }\n      // ã‚¦ã‚©ãƒ¬ãƒƒãƒˆæ¥ç¶šã‚’æ±‚ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã€‚\n      const accounts = await ethereum.request({\n        method: \"eth_requestAccounts\",\n      });\n      console.log(\"Connected: \", accounts[0]);\n      setCurrentAccount(accounts[0]);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const wave = async () => {\n    try {\n      const { ethereum } = window;\n      if (ethereum) {\n        const provider = new ethers.providers.Web3Provider(ethereum);\n        const signer = provider.getSigner();\n\n        const wavePortalContract = new ethers.Contract(\n          contractAddress,\n          contractABI,\n          signer\n        );\n        // getTotalWavesãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™\n        let count = await wavePortalContract.getTotalWaves();\n        console.log(\"Retrieved total wave count...\", count.toNumber());\n        // ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ®‹é«˜ã‚’å–å¾—ã™ã‚‹ã€‚\n        let contractBalance = await provider.getBalance(wavePortalContract.address);\n        console.log(\"Contract balance:\", ethers.utils.formatEther(contractBalance));\n        // waveãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã—ã¦å®Ÿè¡Œã™ã‚‹ã€‚\n        const waveTxn = await wavePortalContract.wave(messageValue, {\n          gasLimit: 300000,\n        });\n        console.log(\"Mining...\", waveTxn.hash);\n        await waveTxn.wait();\n        console.log(\"Mined -- \", waveTxn.hash);\n        count = await wavePortalContract.getTotalWaves();\n        console.log(\"Retrieved total wave count...\", count.toNumber());\n\n        let contractBalance_post = await provider.getBalance(wavePortalContract.address);\n        /* ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ®‹é«˜ãŒæ¸›ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª */\n        if (contractBalance_post < contractBalance) {\n          /* æ¸›ã£ã¦ã„ãŸã‚‰ä¸‹è¨˜ã‚’å‡ºåŠ› */\n          console.log(\"User won ETH!\");\n        } else {\n          console.log(\"User didn't win ETH.\");\n        }\n        console.log(\"Contract balance after wave:\", ethers.utils.formatEther(contractBalance_post));\n        setWaveBalance(ethers.utils.formatEther(contractBalance_post));\n      } else {\n        console.log(\"Ethereum object doesn't exist!\");\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  return (\n    <div className=\"mainContainer\">\n      <div className=\"dataContainer\">\n        <div className=\"header\">\n          <span role=\"img\" aria-label=\"hand-wave\">\n            ğŸ‘‹\n          </span> { \" \" }\n          WELCOME!\n        </div>\n        <div >\n          ã‚¤ãƒ¼ã‚µãƒªã‚¢ãƒ ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’æ¥ç¶šã—ã¦ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä½œæˆã—ãŸã‚‰ã€\n          <span role=\"img\" aria-label=\"hand-wave\">\n            ğŸ‘‹\n          </span>\n          ã‚’é€ã£ã¦ãã ã•ã„\n          <span role=\"img\" aria-label=\"shine\">\n            âœ¨\n          </span>\n        </div>\n        <div className=\"balance\">\n          ç¾åœ¨ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®è³‡é‡‘ï¼š <b>{waveBalance} ETH</b>\n        </div>\n        <button className=\"waveButton\" onClick={wave}>\n          Wave at Me\n        </button>\n        {/* ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚³ãƒã‚¯ãƒˆã®ãƒœã‚¿ãƒ³ã‚’å®Ÿè£… */}\n        {!currentAccount && (\n          <button className=\"waveButton\" onClick={connectWallet}>\n            Connect Wallet\n          </button>\n        )}\n        {currentAccount && (\n          <button className=\"waveButton\" onClick={connectWallet}>\n            Wallet Connected\n          </button>\n        )}\n        {currentAccount && (\n          <textarea\n            name=\"messageArea\"\n            placeholder=\"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã“ã¡ã‚‰\"\n            type=\"text\"\n            id=\"message\"\n            value={messageValue}\n            onChange={(e) => setMessageValue(e.target.value)}\n          />\n        )}\n        {currentAccount &&\n          allWaves\n            .slice(0)\n            .reverse()\n            .map((wave, index) => {\n              return (\n                <div\n                  key={index}\n                  style={{\n                    backgroundColor: \"#F8F8FF\",\n                    marginTop: \"16px\",\n                    padding: \"8px\",\n                  }}\n                >\n                  <div>Address: {wave.address}</div>\n                  <div>Time: {wave.timestamp.toString()}</div>\n                  <div>Message: {wave.message}</div>\n                </div>\n              );\n            })}\n      </div>\n    </div>\n  );\n}\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}